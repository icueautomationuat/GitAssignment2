This is main original code
